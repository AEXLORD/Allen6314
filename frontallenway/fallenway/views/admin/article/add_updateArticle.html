<html>
    <head>
        <meta charset="utf8">
        <title>愿无岁月可回首</title>

        <link rel="stylesheet" href="/editorMd/css/editormd.min.css" />
        <script src = "/javascripts/jquery.min.js" ></script>
	    <script src="/editorMd/editormd.min.js"></script>

        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)
            },i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-77363750-1', 'auto');
            ga('send', 'pageview');
        </script>
    </head>
    <body style = "padding:20px;">
        <form id = "addForm" action = "addArticle/doAdd" method = "post">
            <input type = "hidden" value = "{{data.article.id}}" name = "id">
	        <div>
		        <div style="float:left">  
                    <input class = "form-control" style="display:inline;width:700px;font-size:20px" 
                        type = "text" id="title" name = "title" value = "{{data.article.title}}" placeholder="Title">
		        </div>
		        <div style="float:right">  
			        <a class="btn btn-primary" href="/admin/article/articleManage">Back</a>
		        </div>
		        <div style="clear:both"></div>
	        </div>
	
            <div id="editormd" style="min-height:600px;margin-top:20px;font-size:16px;">
                <textarea name = "mdData" style="display:none;" id="mdData" >{{data.article.content}}</textarea>
	        </div>

            <div style = "margin-top:15px;">
                Tag:&nbsp;&nbsp;
                <select style="display:inline;width:100px;font-size:20px" id="tagId" name = "tagId">
		            {% for tag in data.tags %}
		            <option value="{{tag.id}}"> {{tag.name}} </option>
                    {% endfor %}
	            </select>
            </div>
            <div style = "margin-top:15px;">
                <button class="btn btn-primary" onclick="doAdd()">Publish</button>
                &nbsp;&nbsp;&nbsp;<span style = "color:red" id = "publishWarn"></span>
                <a class="btn btn-primary" href="/admin/article/articleManage">Back</a>&nbsp;&nbsp;
            </div>
        </form>
    </body>
    <script type="text/javascript">
	    $(function() {
	        var editor = editormd("editormd", {
	            path : "/editorMd/lib/" 
	        });
	    })

	    function doAdd(){

	    	if(validData()){
		    	var url = "addArticle/doAdd";

		    	var data = {
		    		"title":$('#title').val(),
		    		"mdData":$('#mdData').val(),
		    		"tagId":$('#tagId').val(),
		    	}

                $('#addForm').submit();
	    	} else {
	    		;
	    	}
	    }

	    function validData(){
            $('#publishWarn').empty();
	    	var valid = true;

	    	var title = $('#title').val();
	    	if(title == null || title == "" || title.trim() == null){
	    		valid =  false;
	    		$('#publishWarn').append("title不能为空或者只为空格！！");
	    	} else {
	    		;
	    	}

	    	return valid;
	    }
	</script>
</html>



